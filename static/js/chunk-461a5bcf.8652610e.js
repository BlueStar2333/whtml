(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-461a5bcf"],{"72f6":function(e,t,o){"use strict";o("d9ff")},d9ff:function(e,t,o){},efcf:function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"login-wrap"},[o("div",{staticClass:"ms-login"},[o("div",{staticClass:"ms-title"},[e._v("华西医院填表系统")]),o("el-form",{directives:[{name:"show",rawName:"v-show",value:!e.phoneLoginState,expression:"!phoneLoginState"}],ref:"loginForm",staticClass:"ms-content",attrs:{model:e.loginForm,rules:e.loginRules,"label-width":"0px",autocomplete:"on"}},[o("el-form-item",{attrs:{prop:"username"}},[o("el-input",{ref:"username",attrs:{clearable:"",tabindex:"1",autocomplete:"on",placeholder:"Username"},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("el-button",{attrs:{icon:"el-icon-user"}})]},proxy:!0}]),model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),o("el-form-item",[o("el-input",{key:e.passwordType,ref:"password",attrs:{type:e.passwordType,placeholder:"Password",name:"password",tabindex:"2",autocomplete:"on"},on:{blur:function(t){e.capsTooltip=!1}},nativeOn:{keyup:[function(t){return e.checkCapslock(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}]},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("el-button",{attrs:{icon:"el-icon-lock"}})]},proxy:!0}]),model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),o("div",{staticClass:"login-btn"},[o("el-button",{staticStyle:{color:"#e7e7e7"},attrs:{type:"primary"},on:{click:e.handleLogin}},[e._v("登录")])],1)],1),o("el-form",{directives:[{name:"show",rawName:"v-show",value:e.phoneLoginState,expression:"phoneLoginState"}],ref:"ruleForm",staticClass:"ms-content",staticStyle:{"padding-bottom":"16px"},attrs:{model:e.ruleForm,rules:e.rules}},[o("el-form-item",{attrs:{prop:"phone"}},[o("el-input",{staticClass:"phone-inp",attrs:{placeholder:"请输入手机号"},model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}},[o("i",{staticClass:"el-icon-phone",attrs:{slot:"prefix"},slot:"prefix"})])],1),o("el-form-item",{attrs:{prop:"code"}},[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:16}},[o("el-input",{staticClass:"phone-inp",attrs:{placeholder:"请输入验证码"},model:{value:e.ruleForm.code,callback:function(t){e.$set(e.ruleForm,"code",t)},expression:"ruleForm.code"}},[o("i",{staticClass:"el-icon-tickets",attrs:{slot:"prefix"},slot:"prefix"})])],1),o("el-col",{attrs:{span:6}},[o("el-button",{staticStyle:{width:"130px"},attrs:{disabled:e.sendDisabled},on:{click:e.sendCode}},[e._v(e._s(e.btnText))])],1)],1)],1),o("el-form-item",[o("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.phoneLogin}},[e._v("登录")])],1)],1),e.phoneLoginState?o("a",{staticClass:"login-tips",on:{click:function(t){return e.changePhoneLoginState(!1)}}},[e._v("账号密码登录 >")]):o("a",{staticClass:"login-tips",on:{click:function(t){return e.changePhoneLoginState(!0)}}},[e._v("手机号登录 >")])],1)])},r=[],s=(o("ac1f"),o("00b4"),{name:"Login",components:{},data:function(){var e=function(e,t,o){o()},t=function(e,t,o){t.length<6?o(new Error("The password can not be less than 6 digits")):o()},o=function(e,t,o){if(!t)return o(new Error("手机号不能为空"));var n=/^1[3|4|5|7|8][0-9]\d{8}$/;if(!n.test(t))return o(new Error("请输入正确的手机号"));o()};return{loginForm:{username:"",password:""},ruleForm:{phone:"",code:""},btnText:"发送验证码",phoneLoginState:!1,time:60,rules:{phone:[{validator:o,trigger:"change"}],code:[{required:!0,message:"验证码不能为空",trigger:"blur"}]},sendDisabled:!1,loginRules:{username:[{required:!0,trigger:"blur",validator:e}],password:[{required:!0,trigger:"blur",validator:t}]},passwordType:"password",capsTooltip:!1,loading:!1,redirect:"/custom/CommonForm",otherQuery:{}}},computed:{},watch:{},mounted:function(){""===this.loginForm.username?this.$refs.username.focus():""===this.loginForm.password&&this.$refs.password.focus()},methods:{checkCapslock:function(e){var t=e.key;this.capsTooltip=t&&1===t.length&&t>="A"&&t<="Z"},showPwd:function(){var e=this;"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick((function(){e.$refs.password.focus()}))},handleLogin:function(){var e=this;this.$refs.loginForm.validate((function(t){if(!t)return!1;e.loading=!0,e.$store.dispatch("user/login",e.loginForm).then((function(){e.$router.push({path:e.redirect||"/",query:e.otherQuery}),e.loading=!1})).catch((function(){e.loading=!1}))}))},changePhoneLoginState:function(e){this.phoneLoginState=e},phoneLogin:function(){this.$refs.ruleForm.validate((function(e){e?alert("submit"):alert("errHandle")}))},sendCode:function(){var e=this;this.$refs.ruleForm.validateField("phone",(function(t){if(t)e.$message.error(t);else{var o=setInterval((function(){e.time--,e.btnText="".concat(e.time,"s后重新发送"),e.sendDisabled=!0,0===e.time&&(e.sendDisabled=!1,e.btnText="重新发送",e.time=60,clearInterval(o))}),1e3);e.$emit("send")}}))}}}),i=s,a=(o("72f6"),o("2877")),l=Object(a["a"])(i,n,r,!1,null,"303d41ca",null);t["default"]=l.exports}}]);